<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>달력 예제</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fullcalendar/core@6.1.8/main.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fullcalendar/daygrid@6.1.8/main.min.css">
    <link rel="stylesheet" href="../public/css/calendar.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.5.0/semantic.min.css" integrity="sha512-KXol4x3sVoO+8ZsWPFI/r5KBVB/ssCGB5tsv2nVOKwLg33wTFP3fmnXa47FdSVIshVTgsYk/1734xSk9aFIa4A==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- 모달창 용 부트스트랩 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>

    <!-- 공통 라이브러리 js -->
    <script src="../../node_modules/jquery/dist/jquery.min.js"></script>
    <script src="../../node_modules/moment/min/moment.min.js"></script>


<!--    <script src="../public/lib/fullcalendar-6.1.15/dist/index.global.js"></script>-->
    <!--    <script src="../../node_modules/fullcalendar/index.global.min.js"></script>-->
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js'></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/locales-all.js"></script>
<!--    <script src="https://unpkg.com/popper.js/dist/umd/popper.min.js"></script>-->
<!--    <script src="https://unpkg.com/tooltip.js/dist/umd/tooltip.min.js"></script>-->



<!--    <script src="../public/js/calendar.js" defer></script>-->
</head>
<body>

<header class="header">
    <div class="header__title"><i class="chevron left icon"></i>일정</div>
</header>
<main>
    <div id="calendar"></div>
    <div class="modal-main"></div>
</main>



<script>
    document.addEventListener('DOMContentLoaded', function() {
        calendar_rendering();
    });

    function calendar_rendering() {
        const today = new Date();

        var calendarEl = document.getElementById('calendar');
        var calendar = new FullCalendar.Calendar(calendarEl, {
            height : '100%',
            locale: "ko",
            firstDay: 0, // 0 일요일
            headerToolbar: {
                center: 'timeGridDay dayGridMonth'
            },
            initialView: 'dayGridMonth',
            initialDate: today,
            navLinks: true, // can click day/week names to navigate views
            selectable: true,
            selectMirror: true,
            select: function(arg) { // 일정추가 할때 날짜 박스 클릭하면 이벤트 발생
                var title = prompt('이벤트 추가:');
                if (title) {
                    calendar.addEvent({
                        title: title,
                        start: arg.start,
                        end: arg.end,
                        allDay: arg.allDay
                    })
                }
                calendar.unselect()
            },
            eventClick: function(info) {
                console.log("===================");
                console.log(info.event); //
                console.log(info.jsEvent.pageX + ',' + info.jsEvent.pageY);
                console.log(info.event.id); // 클릭한 일정 ID (있을수도, 없을수도)
                console.log(info.event.title); // 클릭한 일정 내용(타이틀)
                console.log(moment(info.event.startStr).format("YYYY-MM-DD HH:mm"));  // 클릭한 일정 약속 시간
                console.log(info.event.allDay); // 클릭한 일정 약속 시간
                console.log(info.event.extendedProps);
                console.log("===================");

                $('.modal-main').html(`
                    <!-- Button trigger modal -->
                    <button type="button" class="btn btn-primary modal-btn" data-bs-toggle="modal" data-bs-target="#exampleModal" style="display: none">
                      Launch demo modal
                    </button>
                    <!-- Modal -->
                    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                      <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                          <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                          </div>
                          <div class="modal-body">
                            <p><span>타이틀: </span>${info.event.title}</p>
                            <p><span>일정 시간: </span>${moment(info.event.startStr).format("YYYY-MM-DD HH:mm")}</p>
                            <!-- 추후에 info.event.extendedProps 안에 데이터 확인해서 에러 안나게 만들기 -->
                            <p><span>대상: </span>${info.event.extendedProps.comment.subject}</p>
                            <p><span>상세내용: </span>${info.event.extendedProps.comment.des}</p>
                            <p><span>작성자: </span>${info.event.extendedProps.comment.author}</p>
                            <p><span>...</span></p>
                          </div>
                          <div class="modal-footer">
<!--                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>-->
<!--                            <button type="button" class="btn btn-primary">Save changes</button>-->
                          </div>
                        </div>
                      </div>
                    </div>
                `);

                // 모달창 실행 이벤트
                $('.modal-btn').trigger("click");






                // console.log(calendar.getEventById('a')) // 클릭한내용 ID로 찾기 (ID가 있다면..)
                // console.log(calendar.getEventById('a').title) // 클릭한 일정 내용(타이틀)
                // console.log(calendar.getEventById('a').startStr) // 클릭한 일정 약속 시간
                // console.log(calendar.getEventById('a').allDay) // 클릭한 일정 약속 시간
                // if (confirm('Are you sure you want to delete this event?')) {
                //     arg.event.remove()
                // }
            },
            editable: true,
            dayMaxEvents: true, // allow "more" link when too many events
            events: [
                {
                    "id": "common001",
                    "title": "여름휴가",
                    "start": "2024-08-02",
                    "end":"2024-08-05",
                    "allDay": true,
                    "backgroundColor":"black",
                    "textColor":"pink",
                    "extendedProps": {
                        "comment": {
                            "des":"여름휴가 고고",
                            "subject" : "my",
                            author:"내가"
                        },
                    }
                },
                {
                    id:'a',
                    title: '하루종일 이벤트',
                    start: '2024-07-23',
                    description: 'description for All Day Event', // 툴팁에 들어가는 내용?
                    backgroundColor:"red",
                    textColor:"#fff",
                    extendedProps: {
                        comment: {
                            des:"상세설명",
                            subject : "대상자",
                            author:"자식"
                        },
                    }
                },
                {
                    title: '연속된 요일 이벤트',
                    start: '2024-07-29',
                    end: '2024-07-31' // 종료날짜 + 1 해야 그 전날까지 표시
                },
                {
                    title: '시간별 이벤트',
                    start: '2024-07-29 13:00',
                },
                {
                    title: '시간별 이벤트2',
                    start: '2024-07-29 14:00',
                },
                {
                    title: '시간별 이벤트3',
                    start: '2024-07-29 15:00',
                },
                {
                    title: '시간별 이벤트4',
                    start: '2024-07-29 16:00',
                },
                {
                    title: '시간별 이벤트5',
                    start: '2024-07-29 17:00',
                },
                {
                    title: '시간별 이벤트6',
                    start: '2024-07-29 18:00',
                },
                {
                    title: '시간별 이벤트7',
                    start: '2024-07-29 19:00',
                }
            ]
        });

        calendar.render();
    };



</script>

</body>
</html>
